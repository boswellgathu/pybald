
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Routing and URLs &mdash; Pybald 0.2.8 documentation</title>
    
    <link rel="stylesheet" href="_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Pybald 0.2.8 documentation" href="index.html" />
    <link rel="next" title="Controllers" href="controllers.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<link href="_static/solarized-dark.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="controllers.html" title="Controllers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pybald 0.2.8 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/pybald.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Routing and URLs</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#capturing-variables">Capturing Variables</a></li>
<li><a class="reference internal" href="#variable-requirements">Variable Requirements</a></li>
<li><a class="reference internal" href="#restful-resources">RESTful Resources</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="previous chapter">Configuration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="controllers.html"
                        title="next chapter">Controllers</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/routing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="routing-and-urls">
<h1>Routing and URLs<a class="headerlink" href="#routing-and-urls" title="Permalink to this headline">¶</a></h1>
<p>The Pybald router is used to match web requests and URL&#8217;s with application behaviors, specficially controllers and actions. It can also be used to <em>generate</em> urls symbolically inside of the application and templates to avoid hard coding paths inside of your application.</p>
<p>Pybald routes are defined explicitly using a forked version of the Routes python library.</p>
<p>Routing is defined using functions that accept a &#8216;mapping object&#8217;. This mapping object is used to connect routes and define <em>submappers</em> (described later). The mapping object has a few methods, the most important of which is <cite>connect</cite>. Traditionally the convention is for the mapping object to be named <cite>urls</cite> and the function to be named <cite>map</cite>.</p>
<p>For simple projects, this function is usually defined in the <cite>./app/urls.py</cite> module.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Lets assume you want to create a route for <cite>/blog/posts/45</cite> to show a single blog post with an id, in this case 45. An example url route might look like the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">urls</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;show_post&#39;</span><span class="p">,</span> <span class="s">r&#39;/blog/posts/{id}&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;show&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments to connect are the symbolic name for the route (show_post), the route itself (r&#8217;/blog/posts/{id}&#8217;), and then any variables that will be set when this route is matched. The r&#8217;&#8217; string format is a convention to use &#8216;raw&#8217; strings without interpreting escape sequences. In this case we&#8217;re setting the special controller and action variables so that the router will know which code to execute when this route is matched.</p>
</div>
<div class="section" id="capturing-variables">
<h2>Capturing Variables<a class="headerlink" href="#capturing-variables" title="Permalink to this headline">¶</a></h2>
<p>This particular route has a &#8216;capture variable&#8217;, the {id} portion of the route. By using these variables, you can extract information from the URL to use in your request. This example will additionally set a variable named <cite>id</cite> in the request and set it to any value present in the url. For example, with a request like <cite>/blog/posts/45</cite> the variable id will be set to 45 when the request is processed.</p>
</div>
<div class="section" id="variable-requirements">
<h2>Variable Requirements<a class="headerlink" href="#variable-requirements" title="Permalink to this headline">¶</a></h2>
<p>In the above example you may have noticed that this route match would potentially match on any value present on the url after <cite>/blog/posts/</cite>. If the request was <cite>/blog/posts/frank</cite>, the route would match and id would be <cite>frank</cite>. If, in your application, all ids are interger numbers, this might not be a case you want to have trigger your application behavior.</p>
<p>For this case you can use requirements in your variable captures. Requirements are regular expressions that can be used to limit what will be matched in the variable portion of your url route. Any standard regular expression can be used and would be added after a colon in the capture definition as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">urls</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;show_post&#39;</span><span class="p">,</span> <span class="s">r&#39;/blog/posts/{id:\d+}&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">,</span>
                 <span class="n">action</span><span class="o">=</span><span class="s">&#39;show&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we&#8217;ve added the requirement that there be one or more interger values after the url slash (and only interger values) to trigger the route match. This would match <cite>/blog/posts/45</cite> but not <cite>/blog/posts/frank</cite> or even <cite>/blog/posts/45frank</cite>.</p>
</div>
<div class="section" id="restful-resources">
<h2>RESTful Resources<a class="headerlink" href="#restful-resources" title="Permalink to this headline">¶</a></h2>
<p>When creating CRUD applications, Pybald can automatically create a set of RESTful urls using the <cite>collection</cite> method on the mapper object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">urls</span><span class="o">.</span><span class="n">collection</span><span class="p">(</span><span class="s">&#39;posts&#39;</span><span class="p">,</span> <span class="s">&#39;post&#39;</span><span class="p">,</span> <span class="n">path_prefix</span><span class="o">=</span><span class="s">r&#39;/blog&#39;</span><span class="p">,</span>
                    <span class="n">controller</span><span class="o">=</span><span class="s">&#39;blog&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="13%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">symbolic</th>
<th class="head">method</th>
<th class="head">url route</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>posts</td>
<td>GET</td>
<td>/blog/posts{.format}</td>
</tr>
<tr class="row-odd"><td>create_post</td>
<td>POST</td>
<td>/blog/posts{.format}</td>
</tr>
<tr class="row-even"><td>new_post</td>
<td>GET</td>
<td>/blog/posts/new{.format}</td>
</tr>
<tr class="row-odd"><td>post</td>
<td>GET</td>
<td>/blog/posts/{id}{.format}</td>
</tr>
<tr class="row-even"><td>update_post</td>
<td>PUT</td>
<td>/blog/posts/{id}{.format}</td>
</tr>
<tr class="row-odd"><td>delete_post</td>
<td>DELETE</td>
<td>/blog/posts/{id}{.format}</td>
</tr>
<tr class="row-even"><td>edit_post</td>
<td>GET</td>
<td>/blog/posts/{id}/edit{.format}</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="controllers.html" title="Controllers"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >previous</a> |</li>
        <li><a href="index.html">Pybald 0.2.8 documentation</a> &raquo;</li> 
      </ul>
    </div>
  
    <div class="footer">
        &copy; Copyright 2014, Michael Kowalchik.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
  <!-- <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? 
  "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + 
  "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-13190724-1");
  pageTracker._trackPageview();
  } catch(err) {}</script> -->

  </body>
</html>